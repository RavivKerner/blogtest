<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Title | Industry 4.0 - ML applications in manufacturing</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://ravivkerner.github.io/blogtest/2021/12/27/test.html" />
<meta property="og:url" content="https://ravivkerner.github.io/blogtest/2021/12/27/test.html" />
<meta property="og:site_name" content="Industry 4.0 - ML applications in manufacturing" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-27T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Title" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-27T00:00:00-06:00","datePublished":"2021-12-27T00:00:00-06:00","description":"An easy to use blogging platform with support for Jupyter Notebooks.","headline":"Title","mainEntityOfPage":{"@type":"WebPage","@id":"https://ravivkerner.github.io/blogtest/2021/12/27/test.html"},"url":"https://ravivkerner.github.io/blogtest/2021/12/27/test.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blogtest/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ravivkerner.github.io/blogtest/feed.xml" title="Industry 4.0 - ML applications in manufacturing" /><link rel="shortcut icon" type="image/x-icon" href="/blogtest/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blogtest/">Industry 4.0 - ML applications in manufacturing</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blogtest/about/">About Me</a><a class="page-link" href="/blogtest/search/">Search</a><a class="page-link" href="/blogtest/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-12-27T00:00:00-06:00" itemprop="datePublished">
        Dec 27, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/RavivKerner/blogtest/tree/master/_notebooks/2021-12-27-test.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blogtest/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/RavivKerner/blogtest/master?filepath=_notebooks%2F2021-12-27-test.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blogtest/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/RavivKerner/blogtest/blob/master/_notebooks/2021-12-27-test.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blogtest/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FRavivKerner%2Fblogtest%2Fblob%2Fmaster%2F_notebooks%2F2021-12-27-test.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blogtest/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-12-27-test.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">Uqq</span> <span class="n">fastbook</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>     |████████████████████████████████| 720 kB 6.8 MB/s 
     |████████████████████████████████| 46 kB 4.5 MB/s 
     |████████████████████████████████| 1.2 MB 44.2 MB/s 
     |████████████████████████████████| 189 kB 46.3 MB/s 
     |████████████████████████████████| 56 kB 5.6 MB/s 
     |████████████████████████████████| 51 kB 392 kB/s 
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">fastbook</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">fastbook</span><span class="o">.</span><span class="n">setup_book</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">fastbook</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Key Loss func &amp; matrics by fastai</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="c1">#MSE for loss and matric</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">Binary_cls_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">Binary_metric_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
  <span class="n">pred_accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">&gt;</span><span class="n">threshhold</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">pred_accuracy</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">mnist_loss</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">batch_accuracy</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">==</span> <span class="n">yb</span>
    <span class="k">return</span> <span class="n">correct</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">9.4077</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3319</span><span class="p">,</span>  <span class="mf">9.3460</span><span class="p">,</span>  <span class="mf">5.9358</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Binary_cls_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">mnist_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.6971), tensor(0.6971))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">9.4077</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3319</span><span class="p">],</span>  <span class="p">[</span><span class="mf">9.3460</span><span class="p">,</span>  <span class="mf">5.9358</span><span class="p">],[</span><span class="mf">9.3460</span><span class="p">,</span>  <span class="mf">5.9358</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.3460</span><span class="p">,</span>  <span class="mf">5.9358</span><span class="p">]</span> <span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1">#will not work becuase in class he build calssifiers give only onr resoult</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(3.5618)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Binary_metric_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">batch_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.2500), tensor(0.2500))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">softmaxp1</span><span class="p">(</span><span class="n">preds</span><span class="p">):</span>
  <span class="n">sume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># sume.reshape((len(preds),1))</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">/</span><span class="n">sume</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">multi_c_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">soft</span> <span class="o">=</span> <span class="n">softmaxp1</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">softcon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">soft</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">softcon</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">multi_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">to_C</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">to_C</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">sm_acts</span><span class="p">,</span> <span class="n">targ</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1">#negative log likelihood (but it asumed you already took the log...)</span>
<span class="c1">#(its because pytorch desgin log_softmax function which take soft_max and log together)</span>
<span class="c1">#the &#39;reduction = None &#39; io show per row and not average, by default all loss function in Pytorch takes the mean</span>

<span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">acts</span><span class="p">,</span> <span class="n">targ</span><span class="p">)</span> <span class="c1">#softmax+negative log likelihood</span>
<span class="c1"># which, in practice, actually does log_softmax and then nll_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">8.8227</span><span class="p">,</span> <span class="mf">9.1500</span><span class="p">,</span> <span class="mf">3.8286</span><span class="p">,</span> <span class="mf">9.5931</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.9045</span><span class="p">,</span> <span class="mf">6.0090</span><span class="p">,</span> <span class="mf">2.5657</span><span class="p">,</span> <span class="mf">7.9364</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">9.4077</span><span class="p">,</span> <span class="mf">1.3319</span><span class="p">,</span> <span class="mf">9.3460</span><span class="p">,</span> <span class="mf">5.9358</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.6940</span><span class="p">,</span> <span class="mf">5.6772</span><span class="p">,</span> <span class="mf">7.4109</span><span class="p">,</span> <span class="mf">4.2940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.8544</span><span class="p">,</span> <span class="mf">5.7390</span><span class="p">,</span> <span class="mf">2.6658</span><span class="p">,</span> <span class="mf">6.2745</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1">#negative log likelihood (but it asumed you already took the log...)</span>
<span class="c1">#(its because pytorch degin log_softmax function which take soft_max and log together)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-8.8227, -6.0090, -1.3319, -7.4109, -6.2745])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">loss_func_nn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_c_loss</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">loss_func_nn</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1">#dont work directly like F</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(3.3246),
 tensor(3.3246),
 tensor([1.5161, 2.0826, 8.7546, 1.5746, 2.6952]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">softmax</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="o">==</span> <span class="n">softmaxp1</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[True, True, True, True],
        [True, True, True, True],
        [True, True, True, True],
        [True, True, True, True],
        [True, True, True, True]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="c1">#name of all functionsV</span>
<span class="c1">#didnt show accuracy function</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">multi_l_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">sig</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dist</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">multi_l_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
  <span class="n">sig_preds</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">bin_conv</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_preds</span><span class="o">&gt;</span><span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">bin_conv</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="c1"># F.binary_cross_entropy and its module equivalent nn.BCELoss calculate cross-entropy on a one-hot-encoded target, but do not include the initial sigmoid</span>
<span class="c1"># F.binary_cross_entropy_with_logits (or nn.BCEWithLogitsLoss) include sigmoid </span>

<span class="c1"># The equivalent for single-label datasets (like MNIST or the Pet dataset), where the target is encoded as a single integer,</span>
<span class="c1">#  is F.nll_loss or nn.NLLLoss for the version without the initial softmax, </span>
<span class="c1">#  and F.cross_entropy or nn.CrossEntropyLoss for the version with the initial softmax.</span>

<span class="k">def</span> <span class="nf">accuracy_multi</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">targ</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sigmoid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="s2">&quot;Compute accuracy when `inp` and `targ` are the same size.&quot;</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">targ</span> <span class="o">=</span> <span class="n">targ</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">inp</span><span class="o">&gt;</span><span class="n">thresh</span><span class="p">)</span><span class="o">==</span><span class="n">targ</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">8.8227</span><span class="p">,</span> <span class="mf">9.1500</span><span class="p">,</span> <span class="mf">3.8286</span><span class="p">,</span> <span class="mf">9.5931</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.9045</span><span class="p">,</span> <span class="mf">6.0090</span><span class="p">,</span> <span class="mf">2.5657</span><span class="p">,</span> <span class="mf">7.9364</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">9.4077</span><span class="p">,</span> <span class="mf">1.3319</span><span class="p">,</span> <span class="mf">9.3460</span><span class="p">,</span> <span class="mf">5.9358</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.6940</span><span class="p">,</span> <span class="mf">5.6772</span><span class="p">,</span> <span class="mf">7.4109</span><span class="p">,</span> <span class="mf">4.2940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.8544</span><span class="p">,</span> <span class="mf">5.7390</span><span class="p">,</span> <span class="mf">2.6658</span><span class="p">,</span> <span class="mf">6.2745</span><span class="p">]])</span>

<span class="n">y</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="c1">#standart pytorch wont work, need to change to float</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.int64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">lss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_l_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">lss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(4.5089), tensor(4.5089))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">accuracy_multi</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">multi_l_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorBase(0.3500), tensor(0.3500))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">binary_cross_entropy_with_logits</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-42-f1b49aa95af6&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>F<span class="ansi-blue-fg">.</span>binary_cross_entropy_with_logits<span class="ansi-blue-fg">(</span>preds<span class="ansi-blue-fg">,</span>y<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py</span> in <span class="ansi-cyan-fg">binary_cross_entropy_with_logits</span><span class="ansi-blue-fg">(input, target, weight, size_average, reduce, reduction, pos_weight)</span>
<span class="ansi-green-intense-fg ansi-bold">   2980</span>         <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Target size ({}) must be the same as input size ({})&#34;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>target<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2981</span> 
<span class="ansi-green-fg">-&gt; 2982</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> torch<span class="ansi-blue-fg">.</span>binary_cross_entropy_with_logits<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">,</span> target<span class="ansi-blue-fg">,</span> weight<span class="ansi-blue-fg">,</span> pos_weight<span class="ansi-blue-fg">,</span> reduction_enum<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2983</span> 
<span class="ansi-green-intense-fg ansi-bold">   2984</span> 

<span class="ansi-red-fg">RuntimeError</span>: result type Float can&#39;t be cast to the desired output type Long</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
<span class="n">multi_l_accuracy</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">accuracy_multi</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TensorBase(0.3500)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">accuracy_multi</span><span class="err">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">flatten_check</span><span class="err">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">((</span><span class="n">inp</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">==</span><span class="n">y</span><span class="o">.</span><span class="n">bool</span><span class="p">())</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.3500)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">inp</span><span class="o">=</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span>
<span class="n">inp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.9999, 0.9999, 0.9787, 0.9999],
        [0.9802, 0.9975, 0.9286, 0.9996],
        [0.9999, 0.7912, 0.9999, 0.9974],
        [0.9998, 0.9966, 0.9994, 0.9865],
        [0.9999, 0.9968, 0.9350, 0.9981]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ True, False, False, False],
        [ True,  True, False, False],
        [False, False, False, False],
        [False, False, False,  True],
        [False,  True,  True,  True]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">Binary_cls_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Binary_cls_loss</span><span class="p">(</span><span class="n">randres</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.6971)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">randres</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.6971)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">plot_function</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastbook/__init__.py:74: UserWarning: Not providing a value for linspace&#39;s steps is deprecated and will throw a runtime error in a future release. This warning will appear only once per process. (Triggered internally at  /pytorch/aten/src/ATen/native/RangeFactories.cpp:25.)
  x = torch.linspace(min,max)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">plot_function</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastbook/__init__.py:74: UserWarning: Not providing a value for linspace&#39;s steps is deprecated and will throw a runtime error in a future release. This warning will appear only once per process. (Triggered internally at  ../aten/src/ATen/native/RangeFactories.cpp:23.)
  x = torch.linspace(min,max)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">Binary_metric_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">threshhold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
  <span class="n">pred_accuracy</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">&gt;</span><span class="n">threshhold</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">pred_accuracy</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">((</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.2500)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Binary_metric_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.2500)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1, 2, 2, 3])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 9.4077, -1.3319,  9.3460,  5.9358])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">preds2</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">9.4077</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3319</span><span class="p">,</span>  <span class="mf">2.3460</span><span class="p">,</span>  <span class="mf">3.9358</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">softmaxp1</span><span class="p">(</span><span class="n">preds</span><span class="p">):</span>
  <span class="n">sume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># sume.reshape((len(preds),1))</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">/</span><span class="n">sume</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multiperds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multiperds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">8.8227</span><span class="p">,</span> <span class="mf">9.1500</span><span class="p">,</span> <span class="mf">3.8286</span><span class="p">,</span> <span class="mf">9.5931</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.9045</span><span class="p">,</span> <span class="mf">6.0090</span><span class="p">,</span> <span class="mf">2.5657</span><span class="p">,</span> <span class="mf">7.9364</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">9.4077</span><span class="p">,</span> <span class="mf">1.3319</span><span class="p">,</span> <span class="mf">9.3460</span><span class="p">,</span> <span class="mf">5.9358</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.6940</span><span class="p">,</span> <span class="mf">5.6772</span><span class="p">,</span> <span class="mf">7.4109</span><span class="p">,</span> <span class="mf">4.2940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.8544</span><span class="p">,</span> <span class="mf">5.7390</span><span class="p">,</span> <span class="mf">2.6658</span><span class="p">,</span> <span class="mf">6.2745</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sf</span> <span class="o">=</span> <span class="n">softmaxp1</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span>
<span class="n">sf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[2.1956e-01, 3.0457e-01, 1.4881e-03, 4.7438e-01],
        [1.5190e-02, 1.2460e-01, 3.9822e-03, 8.5622e-01],
        [5.0722e-01, 1.5773e-04, 4.7687e-01, 1.5753e-02],
        [7.4715e-01, 3.6579e-02, 2.0709e-01, 9.1731e-03],
        [8.9111e-01, 3.9530e-02, 1.8292e-03, 6.7530e-02]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">logsf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.5161, 1.1888, 6.5102, 0.7457],
        [4.1871, 2.0826, 5.5259, 0.1552],
        [0.6788, 8.7546, 0.7405, 4.1507],
        [0.2915, 3.3083, 1.5746, 4.6915],
        [0.1153, 3.2307, 6.3039, 2.6952]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5161</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.21956652877963362</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0, 1, 1, 2, 3])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logsf</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(3.3246)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">multipredsf</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(5.9698), tensor([8.8227, 6.0090, 1.3319, 7.4109, 6.2745]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">multi_c_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">soft</span> <span class="o">=</span> <span class="n">softmaxp1</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">softcon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">soft</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">softcon</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_loss</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(3.3247)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">((</span><span class="n">multipredsf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">multi_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">to_C</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">to_C</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_accuracy</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multipredsf</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">8.8227</span><span class="p">,</span> <span class="mf">9.1500</span><span class="p">,</span> <span class="mf">3.8286</span><span class="p">,</span> <span class="mf">9.5931</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.9045</span><span class="p">,</span> <span class="mf">6.0090</span><span class="p">,</span> <span class="mf">2.5657</span><span class="p">,</span> <span class="mf">7.9364</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">9.4077</span><span class="p">,</span> <span class="mf">1.3319</span><span class="p">,</span> <span class="mf">9.3460</span><span class="p">,</span> <span class="mf">5.9358</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.6940</span><span class="p">,</span> <span class="mf">5.6772</span><span class="p">,</span> <span class="mf">7.4109</span><span class="p">,</span> <span class="mf">4.2940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">8.8544</span><span class="p">,</span> <span class="mf">5.7390</span><span class="p">,</span> <span class="mf">2.6658</span><span class="p">,</span> <span class="mf">6.2745</span><span class="p">]])</span>

<span class="n">y</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[8.8227, 9.1500, 3.8286, 9.5931],
        [3.9045, 6.0090, 2.5657, 7.9364],
        [9.4077, 1.3319, 9.3460, 5.9358],
        [8.6940, 5.6772, 7.4109, 4.2940],
        [8.8544, 5.7390, 2.6658, 6.2745]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1, 0, 0, 0],
        [1, 1, 0, 0],
        [0, 0, 0, 0],
        [0, 0, 0, 1],
        [0, 1, 1, 1]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sig</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span>
<span class="n">sig</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.9999, 0.9999, 0.9787, 0.9999],
        [0.9802, 0.9975, 0.9286, 0.9996],
        [0.9999, 0.7912, 0.9999, 0.9974],
        [0.9998, 0.9966, 0.9994, 0.9865],
        [0.9999, 0.9968, 0.9350, 0.9981]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="p">((</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[9.9985e-01, 1.0622e-04, 2.1277e-02, 6.8188e-05],
        [9.8025e-01, 9.9755e-01, 7.1379e-02, 3.5739e-04],
        [8.2135e-05, 2.0885e-01, 8.7261e-05, 2.6361e-03],
        [1.6761e-04, 3.4114e-03, 6.0427e-04, 9.8653e-01],
        [1.4269e-04, 9.9679e-01, 9.3498e-01, 9.9812e-01]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">multi_l_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="n">sig</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dist</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">multi_l_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
  <span class="n">sig_preds</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
  <span class="n">bin_conv</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig_preds</span><span class="o">&gt;</span><span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">bin_conv</span><span class="o">==</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_l_accuracy</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.3500)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">multi_l_loss</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(4.5089)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1, 0, 0, 0],
        [1, 1, 0, 0],
        [0, 0, 0, 0],
        [0, 0, 0, 1],
        [0, 1, 1, 1]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.4734e-04, 9.9989e-01, 9.7872e-01, 9.9993e-01],
        [1.9753e-02, 2.4505e-03, 9.2862e-01, 9.9964e-01],
        [9.9992e-01, 7.9115e-01, 9.9991e-01, 9.9736e-01],
        [9.9983e-01, 9.9659e-01, 9.9940e-01, 1.3466e-02],
        [9.9986e-01, 3.2076e-03, 6.5022e-02, 1.8802e-03]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">((</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">())))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(4.5089)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">sig</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.4734e-04, 9.9989e-01, 9.7872e-01, 9.9993e-01],
        [1.9753e-02, 2.4505e-03, 9.2862e-01, 9.9964e-01],
        [9.9992e-01, 7.9115e-01, 9.9991e-01, 9.9736e-01],
        [9.9983e-01, 9.9659e-01, 9.9940e-01, 1.3466e-02],
        [9.9986e-01, 3.2076e-03, 6.5022e-02, 1.8802e-03]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">multipredsf</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.4734e-04, 9.9989e-01, 9.7872e-01, 9.9993e-01],
        [1.9753e-02, 2.4505e-03, 9.2862e-01, 9.9964e-01],
        [9.9992e-01, 7.9115e-01, 9.9991e-01, 9.9736e-01],
        [9.9983e-01, 9.9659e-01, 9.9940e-01, 1.3466e-02],
        [9.9986e-01, 3.2076e-03, 6.5022e-02, 1.8802e-03]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1, 2, 2, 3],
        [2, 4, 8, 2]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0, -1, -1, -2],
        [-1, -3, -7, -1]])</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/blogtest/2021/12/27/test.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blogtest/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blogtest/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blogtest/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blogtest/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blogtest/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
